<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Student Management - IT Department</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-4">
    <h3>Student Management</h3>

    <!-- Add Student Form -->
    <form method="POST" class="row g-3 mb-4">
        <div class="col-12"><input name="name" class="form-control" placeholder="Name" required></div>
        <div class="col-12"><input name="reg_no" class="form-control" placeholder="Reg No" required></div>
        <div class="col-12"><input name="year" class="form-control" placeholder="Year (1st/2nd/3rd BCA)" required></div>
        <div class="col-12"><input name="section" class="form-control" placeholder="Section"></div>
        <div class="col-12"><input name="email" class="form-control" placeholder="Email"></div>
        <div class="col-12"><input name="phone" class="form-control" placeholder="Phone"></div>
        <div class="col-12"><button class="btn btn-dark w-100">Add Student</button></div>
    </form>

    <!-- Search Box -->
    <input type="text" id="studentSearch" placeholder="Search student by name..." class="form-control w-50 mb-3">

    <!-- Students Table -->
    <table id="studentTable" class="table table-bordered table-striped text-center align-middle">
        <thead class="table-dark">
            <tr>
                <th>#</th>
                <th>Name</th>
                <th>Reg No</th>
                <th>Year</th>
                <th>Section</th>
                <th>Email</th>
                <th>Phone</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% if students %}
                {% for s in students %}
                <tr>
                    <td>{{ loop.index }}</td>
                    <td>{{ s[1] }}</td> <!-- name -->
                    <td>{{ s[2] }}</td> <!-- reg_no -->
                    <td>{{ s[3] }}</td> <!-- year/class -->
                    <td>{{ s[4] }}</td> <!-- section -->
                    <td>{{ s[5] }}</td> <!-- email -->
                    <td>{{ s[6] }}</td> <!-- phone -->
                    <td>
                        <a href="{{ url_for('delete_student', id=s[0]) }}" class="btn btn-danger btn-sm">Delete</a>
                    </td>
                </tr>
                {% endfor %}
            {% else %}
                <tr>
                    <td colspan="8">No students found.</td>
                </tr>
            {% endif %}
        </tbody>
    </table>
</div>

<!-- Search Script -->
<script>
function searchStudent() {
    let input = document.getElementById("studentSearch").value.toLowerCase();
    let table = document.getElementById("studentTable");
    let rows = table.getElementsByTagName("tr");

    for (let i = 1; i < rows.length; i++) {
        let nameCell = rows[i].getElementsByTagName("td")[1];
        if (nameCell) {
            let nameText = nameCell.textContent || nameCell.innerText;
            rows[i].style.display = nameText.toLowerCase().includes(input) ? "" : "none";
        }
    }
}

document.getElementById("studentSearch").addEventListener("keyup", searchStudent);
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
